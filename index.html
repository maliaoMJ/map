<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <!--width - 可视区域的宽度，值可为数字或关键词device-width -->
    <!--height - viewport的高度-->
    <!--initial-scale - 初始的缩放比例-->
    <!--minimum-scale - 允许用户缩放到的最小比例-->
    <!--maximum-scale - 允许用户缩放到的最大比例-->
    <!--user-scalable - 用户是否可以手动缩放-->
    <meta name = "viewport" content = "width = device-width, initial-scale = 1.0, maximum-scale = 1.0, user-scalable = 0" />
    <!--content="telephone=yes" 在iPhone 手机上默认值是（电话号码显示为拨号的超链接）：-->
    <!--可将telephone=no，则手机号码不被显示为拨号链接-->
    <!--使设备浏览网页时对数字不启用电话功能（不同设备解释不同，itouch点击数字为存入联系人，iphone为拨打电话），忽略将页面中的数字识别为电话号码。-->
    <meta name="format-detection" content="telephone=no" />
    <!--忽略识别邮箱-->
    <meta name="format-detection" content="email=no" />
    <!--网站开启对 web app 程序的支持-->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <!--在 web app 应用下状态条（屏幕顶部条）的颜色；(改变顶部状态条的颜色)-->
    <!--默认值为 default（白色），可以定为 black（黑色）和 black-translucent（灰色半透明）；-->
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <!--http-equiv="Content-Type" 表示描述文档类型-->
    <!--HTTP-EQUIV类似于HTTP的头部协议，它回应给浏览器一些有用的信息，以帮助正确和精确地显示网页内容-->
    <meta http-equiv="Content-Type" content="text/html">
    <!-- UC默认竖屏 ，UC强制全屏 -->
    <meta name="full-screen" content="yes">
    <!--使用了application这种应用模式后，页面讲默认全屏，禁止长按菜单，禁止收拾，标准排版，以及强制图片显示。-->
    <!--应用模式-->
    <meta name="browsermode" content="application">
    <!-- QQ强制竖屏 QQ强制全屏 -->
    <!--设置屏幕方向-->
    <meta name="x5-orientation" content="portrait">
    <!--设置全屏-->
    <meta name="x5-fullscreen" content="true">
    <!--设置屏幕模式-->
    <meta name="x5-page-mode" content="app">
    <!-- windows phone 点击无高光 -->
    <meta name="msapplication-tap-highlight" content="no">
    <title>公共地图</title>
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.1.1/css/bootstrap.css">
    <style>
        *{
            padding: 0;
            margin: 0;
        }
        body{

        }
        #container{

            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .map{

            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .anchorBL img{
        	display: none!important;
        }
       .anchorBL{
  
       	    left: 10px!important;
       }
       .loaddingBox{
       	position:absolute;
       	width: 100%;
       	height: 100%;
       	background: rgba(0,0,0,0.6);
       	/* display: none; */
       }
       .loadding{
       	position: absolute;
       	top: 50%;
       	left: 50%;
       	width: 200px;
       	height: 100px;
       	margin-left: -100px;
       	margin-top: -50px;
       	background:white;
       	border-radius: 5px;
       }
       .loaddingText{
       	position: absolute;
       	bottom: 0;
       	left: 0;
       	height: 40px;
       	width: 100%;
       	line-height: 40px;
       	text-align: center;
       	/* background: red; */
       	border-bottom-left-radius: 5px;
       	border-bottom-right-radius: 5px;
       }
       .loaddingImg{
       	position: absolute;
       	top: 0;
       	left: 0;
       	height: 60px;
       	width: 100%;
       	line-height: 40px;
       	text-align: center;
       	/* background: yellow; */
       	border-top-left-radius: 5px;
       	border-top-right-radius: 5px;
       }
      .spinner {
		  width: 40px;
		  height: 40px;
		  position: relative;
		  margin: 15px auto;
		}
 
.double-bounce1, .double-bounce2 {
	  width: 100%;
	  height: 100%;
	  border-radius: 50%;
	  background-color: blue;
	  opacity: 0.8;
	  position: absolute;
	  top: 0;
	  left: 0;
	  font-size: 20px;
	  color: white;

	   
	  -webkit-animation: bounce 2.0s infinite ease-in-out;
	  animation: bounce 2.0s infinite ease-in-out;
	}
	 
	.double-bounce2 {
	  -webkit-animation-delay: -1.0s;
	  animation-delay: -1.0s;
	}
	 
	@-webkit-keyframes bounce {
	  0%, 100% { -webkit-transform: scale(0.0) }
	  50% { -webkit-transform: scale(1.0) }
	}
	 
	@keyframes bounce {
	  0%, 100% {
	    transform: scale(0.0);
	    -webkit-transform: scale(0.0);
	  } 50% {
	    transform: scale(1.0);
	    -webkit-transform: scale(1.0);
	  }
	}
     
    </style>
</head>
<body>
   <div id="container" >
       <div class="map" id="map"></div>
       <div class="loaddingBox" id="loaddingBox">
       	<div class="loadding">
       		<div class="loaddingImg">
       			<div class="spinner">
				  <div class="double-bounce1"><i class="glyphicon glyphicon-map-marker" ></i></div>
				  <div class="double-bounce2"><i class="glyphicon glyphicon-map-marker" ></i></div>
				</div>
       		</div>
       		<div class="loaddingText">

       			<span>请稍后,正在定位中...</span>
       		</div>
       	</div>
       </div>
   </div>
</body>
<script type="text/javascript" src="https://cdn.bootcss.com/jquery/2.0.2/jquery.js"></script>
<script type="text/javascript" src="https://cdn.bootcss.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://api.map.baidu.com/api?v=2.0&ak=yagU5lCyDBe56ulivYD3WA0SNudLMvtx&s=1；"></script>
<script>
  window.onload=function(){
 
	// var marker = new BMap.Marker(point);        // 创建标注    
 //    map.addOverlay(marker); 
 //    marker.addEventListener("click", function(){    
	//  alert("您点击了标注");    
	// });
	// //拖动marker
	// marker.enableDragging();    
	// marker.addEventListener("dragend", function(e){    
	//  alert("当前位置：" + e.point.lng + ", " + e.point.lat);    
	// });
	// //释放内存 marker
	// map.removeOverlay(marker);    
 //    //marker.dispose(); // 1.1 版本不需要这样调用
 //    //信息窗口
 //    var opts = {    
	//  width : 250,     // 信息窗口宽度    
	//  height: 100,     // 信息窗口高度    
	//  title : "Hello"  // 信息窗口标题   
	// }    
	// var infoWindow = new BMap.InfoWindow("World", opts);  // 创建信息窗口对象    
	// map.openInfoWindow(infoWindow, map.getCenter());      // 打开信息窗口
	// //折线覆盖物
	// var polyline = new BMap.Polyline([    
	//    new BMap.Point(116.399, 39.910),    
	//    new BMap.Point(116.405, 39.920)    
	//  ],    
	//  {strokeColor:"blue", strokeWeight:6, strokeOpacity:0.5}    
	// );    
	// map.addOverlay(polyline);
	// //添加图层
	// // var traffic = new BMap.TrafficLayer();        // 创建交通流量图层实例      
 // //    map.addTileLayer(traffic);                    // 将图层添加到地图上
 //    //全景
 // //    var stCtrl = new BMap.PanoramaControl();  
	// // stCtrl.setOffset(new BMap.Size(20, 20));  
	// // map.addControl(stCtrl);
	// //获取定位
	
    //全局便变量
    var loaddingBox = document.getElementById("loaddingBox");
    var latitude = null; // 纬度
    var longitude =null; //经度
	// Loading 获取地址位置加载过程的动画	
	function LoadingAnimated(flag){
       if(flag){
          loaddingBox.style.display="none";
       }else{
          loaddingBox.style.display="block";
       }
	}
	 	
	/** 地图初始化 中心点北京*/
	 	var map = new BMap.Map("map");                // 创建地图实例  
		//var point = new BMap.Point(116.404, 39.915);  // 创建点坐标  
		//map.centerAndZoom(point, 15); 
		map.addControl(new BMap.NavigationControl());    
		map.addControl(new BMap.ScaleControl());    
		map.addControl(new BMap.OverviewMapControl());    
		map.addControl(new BMap.MapTypeControl());    
		map.setCurrentCity("北京"); // 仅当设置城市信息时，MapTypeControl的切换功能才能可用 
		/** 获取地址位置 通过游览器 (定的莫名奇怪，坐标转换也没有用。。。。)*/
		var geolocation = new BMap.Geolocation();
		geolocation.getCurrentPosition(function(result){
			if(this.getStatus() == BMAP_STATUS_SUCCESS){
				LoadingAnimated(true);//关闭加载动画
				var mk = new BMap.Marker(result.point);
				map.addOverlay(mk);
				map.panTo(result.point);
				latitude = result.point.lat-0;
				longitude = result.point.lng-0;
				getResult();
				console.log(result);
			}
			else {
				console.log('failed'+this.getStatus());
				alert('获取您当前的地址位置失败！请查看您是否开启位置等相关权限！');
			}        
		},{enableHighAccuracy: true})
		//搜素附近的小吃
		function getResult(){
			var point = new BMap.Point(longitude, latitude);
            map.centerAndZoom(point, 15);
			var local = new BMap.LocalSearch(map,{ renderOptions:{map: map, autoViewport: true}});      
	        local.searchNearby("银行");
		}
		





	  }	


</script>

</html>
